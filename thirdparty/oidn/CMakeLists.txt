set(OIDN_SOURCE_DIR ${GODOT_SOURCE_ROOT_THIRDPARTY_DIR}/oidn)
set(OIDN_SOURCE
    ${OIDN_SOURCE_DIR}/common/platform.cpp
    ${OIDN_SOURCE_DIR}/common/exception.h
    ${OIDN_SOURCE_DIR}/common/barrier.h
    ${OIDN_SOURCE_DIR}/common/thread.cpp
    ${OIDN_SOURCE_DIR}/common/timer.h
    ${OIDN_SOURCE_DIR}/common/tensor.h
    ${OIDN_SOURCE_DIR}/common/platform.h
    ${OIDN_SOURCE_DIR}/common/tensor.cpp
    ${OIDN_SOURCE_DIR}/common/ref.h
    ${OIDN_SOURCE_DIR}/common/thread.h
    ${OIDN_SOURCE_DIR}/core/transfer_function.h
    ${OIDN_SOURCE_DIR}/core/buffer.h
    ${OIDN_SOURCE_DIR}/core/input_reorder.h
    ${OIDN_SOURCE_DIR}/core/filter.cpp
    ${OIDN_SOURCE_DIR}/core/upsample.h
    ${OIDN_SOURCE_DIR}/core/common.h
    ${OIDN_SOURCE_DIR}/core/network.h
    ${OIDN_SOURCE_DIR}/core/image.h
    ${OIDN_SOURCE_DIR}/core/autoencoder.cpp
    ${OIDN_SOURCE_DIR}/core/transfer_function.cpp
    ${OIDN_SOURCE_DIR}/core/node.h
    ${OIDN_SOURCE_DIR}/core/weights_reorder.h
    ${OIDN_SOURCE_DIR}/core/network.cpp
    ${OIDN_SOURCE_DIR}/core/device.cpp
    ${OIDN_SOURCE_DIR}/core/math.h
    ${OIDN_SOURCE_DIR}/core/autoencoder.h
    ${OIDN_SOURCE_DIR}/core/api.cpp
    ${OIDN_SOURCE_DIR}/core/output_reorder.h
    ${OIDN_SOURCE_DIR}/core/device.h
    ${OIDN_SOURCE_DIR}/core/filter.h
    ${OIDN_SOURCE_DIR}/include/OpenImageDenoise/version.h
    ${OIDN_SOURCE_DIR}/include/OpenImageDenoise/oidn.h
    ${OIDN_SOURCE_DIR}/include/OpenImageDenoise/oidn.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/include/mkldnn_debug.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/include/mkldnn.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/include/mkldnn_types.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/include/mkldnn_version.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/include/mkldnn.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/nstl.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/pooling.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_iterator.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/verbose.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/deconvolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/memory.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/scratchpad.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/batch_normalization.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/type_helpers.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/mkldnn_traits.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/lrn.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/reorder.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_desc.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/memory_desc_wrapper.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_iterator.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/verbose.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/rnn.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/math_utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/softmax_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/scratchpad.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/mkldnn_thread_parallel_nd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/inner_product.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_desc.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/z_magic.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/stream.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/concat.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/deconvolution_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/lrn_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/sum_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/shuffle_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/eltwise_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_exec_types.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/rnn_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/pooling_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/eltwise.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/sum.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_attr.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_attr.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/mkldnn_debug.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/inner_product_pd.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/tag_traits.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/engine.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/reorder_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/engine.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/query.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/mkldnn_debug_autogenerated.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/convolution_pd.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/utils.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/inner_product_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/stream.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/batch_normalization_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/memory_desc_wrapper.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/mkldnn_thread.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/c_types_map.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/memory.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/shuffle.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/concat_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive_exec_types.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/softmax.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/memory_tracking.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/primitive.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/convolution_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_lrn_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_1x1_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_concat.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_primitive.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/ref_rnn.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/jit_uni_rnn_postgemm.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/ref_rnn.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/cell_gru_lbr.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/rnn_utils.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/rnn_utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/rnn_reorders.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/cell_gru.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/cell_common.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/cpu_rnn_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/cell_lstm.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/rnn/cell_rnn.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_fp32_wino_conv_2x3.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_dw_conv_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_1x1_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_fp32_wino_conv_4x3.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_conv_kernel.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_reducer.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_inner_product.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ncsp_batch_normalization.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_1x1_conv_kernel.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_lrn.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_conv_kernel.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/nhwc_pooling.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_barrier.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_fp32_wino_conv_4x3_kernel.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_pooling_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_1x1_conv_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_convolution_utils.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_engine.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/simple_sum.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_batch_normalization_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_1x1_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_reorder_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_conv_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_memory.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_conv_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_inner_product.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/xbyak/xbyak.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/xbyak/xbyak_mnemonic.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/xbyak/xbyak_util.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/xbyak/xbyak_bin2hex.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/xbyak/COPYRIGHT
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_lrn.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_deconvolution_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_barrier.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_dw_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_pooling.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_1x1_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_i8i8_pooling.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_lrn.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_eltwise.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_pooling.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_conv_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_lrn.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/nspc_batch_normalization.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_batch_normalization_utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_inner_product_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/nchw_pooling.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_fp32_wino_conv_4x3.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_1x1_conv_kernel.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_lrn.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_reorder.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_convolution_winograd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_deconvolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_sum.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/nchw_pooling.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_u8s8s32x_wino_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_x8s8s32x_inner_product.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jitprofiling/jitprofiling.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jitprofiling/ittnotify_types.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jitprofiling/ittnotify_config.h
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jitprofiling/README.md
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jitprofiling/LICENSE.BSD
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jitprofiling/jitprofiling.c
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jit_utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_utils/jit_utils.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_pool_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_eltwise.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_convolution_utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_reorder_utils.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_fp32_wino_conv_4x3_kernel.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_transpose_src_utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_batch_normalization.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_lrn_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_conv_kernel.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_1x1_conv_kernel.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_lrn.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/simple_sum.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_1x1_conv_kernel.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_batch_normalization.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_deconvolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_reorder.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_1x1_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_softmax_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/gemm_utils_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/gemm_utils_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/jit_avx512_common_gemm_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/jit_avx_gemm_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/jit_avx_gemm_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/ref_gemm_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/jit_avx512_common_gemm_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/f32/ref_gemm_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/gemm.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/os_blas.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_bn_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_at_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_kernel_gemv_s8u8s32_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_gemm_s8u8s32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/ref_gemm_s8x8s32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_gemm_s8u8s32_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/simple_gemm_s8s8s32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_sum_bn_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/gemv.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/ref_gemm_s8x8s32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_kernel_gemv_s8u8s32_kern.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/simple_gemm_s8s8s32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_sum_at_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/common.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_gemv_s8u8s32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_an_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_sum_an_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_gemm_s8u8s32_kern.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_bt_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_u8_copy_sum_bt_kern.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/s8x8s32/jit_avx512_core_gemm_s8u8s32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm/gemm.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_generator.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_lrn_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_dw_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_deconvolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_sum.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/wino_reorder.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_pool_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_1x1_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_1x1_conv_utils.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_reducer.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_convolution_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_reorder.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_sum_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_conv_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/simple_concat.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_softmax.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_conv_kernel.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_conv_winograd_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_shuffle.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_x8s8s32x_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_eltwise_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_concat.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_conv_winograd_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_x8s8s32x_inner_product.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_isa_traits.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_u8s8s32x_wino_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_inner_product.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_shuffle_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_1x1_conv_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_fp32_wino_conv_2x3.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/simple_concat.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/simple_reorder.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_engine.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_convolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_transpose_src_utils.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_1x1_conv_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_batch_normalization_utils.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_inner_product.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_shuffle.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_1x1_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_eltwise.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_pooling.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_dw_conv_kernel_f32.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_x8s8s32x_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx2_1x1_conv_kernel_f32.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/nhwc_pooling.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_softmax.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_concat_pd.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_1x1_deconvolution.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_batch_normalization.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_pooling.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_eltwise.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/nspc_batch_normalization.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_primitive_conf.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_uni_i8i8_pooling.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/simple_q10n.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ncsp_batch_normalization.hpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_sse42_1x1_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/ref_batch_normalization.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/gemm_convolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_core_x8s8s32x_deconvolution.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/cpu_memory.cpp
    ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu/jit_avx512_common_convolution_winograd.cpp
    )

set(OIDN_RTLIGHTMAP_HDR_SOURCE ${OIDN_SOURCE_DIR}/weights/rtlightmap_hdr.tza)
set(OIDN_RTLIGHTMAP_HDR_OUTPUT ${CMAKE_BINARY_INCLUDE_DIR}/thirdparty/oidn/weights/rtlightmap_hdr.gen.cpp)
GENERATE_DENOISE_TZA_TO_CPP(${OIDN_RTLIGHTMAP_HDR_SOURCE} ${OIDN_RTLIGHTMAP_HDR_OUTPUT})

godot_add_library(oidn thirdparty STATIC ${OIDN_SOURCE} ${OIDN_RTLIGHTMAP_HDR_OUTPUT})
target_include_directories(oidn PRIVATE
                           ${OIDN_SOURCE_DIR}
                           ${OIDN_SOURCE_DIR}/mkl-dnn/include
                           ${OIDN_SOURCE_DIR}/mkl-dnn/src
                           ${OIDN_SOURCE_DIR}/mkl-dnn/src/cpu
                           ${OIDN_SOURCE_DIR}/mkl-dnn/src/common
                           ${OIDN_SOURCE_DIR}/mkl-dnn/src/common/cpu)
target_compile_definitions(oidn PRIVATE 
                            "MKLDNN_THR=MKLDNN_THR_SEQ"
                            "__STDC_CONSTANT_MACROS"
                            "__STDC_LIMIT_MACROS"
                            "DISABLE_VERBOSE"
                            "MKLDNN_ENABLE_CONCURRENT_EXEC")
target_compile_definitions(oidn PUBLIC
    "OIDN_STATIC_LIB"
)
target_compile_options(oidn PRIVATE -w)
